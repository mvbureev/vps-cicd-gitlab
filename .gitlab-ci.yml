docker-build:
  stage: build
  before_script:
    - ls -lsa
    - docker info
    - docker-compose version
    - docker-compose ps
  script:
    - docker-compose config
    - |
      if [[ git diff-tree --no-commit-id --name-only -r HEAD | sed 's/frontend\/\/nextjs/' = nextjs ]]; then
        - docker-compose pull nextjs
        - docker-compose build nextjs
        - docker-compose up -d nextjs
      fi
    - |
      if [[ git diff-tree --no-commit-id --name-only -r HEAD | sed 's/frontend\/\/proxy/' = proxy ]]; then
        - docker-compose pull proxy
        - docker-compose build proxy
        - docker-compose up -d proxy
      fi
    # - docker-compose pull
    # - docker-compose build
    # - docker-compose up -d
 